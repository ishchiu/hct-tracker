# 新竹物流貨態查詢通知系統

純前端（HTML + CSS + JavaScript）版的新竹物流貨態查詢通知網頁

## 功能特色

### ✅ 已實作功能

1. **🤖 完全自動查詢（NEW！）**
   - 一鍵自動查詢新竹物流貨態
   - 使用 Vercel Serverless Function 後端
   - DES CBC 加密呼叫新竹物流官方 API
   - 自動解析並新增所有貨態記錄
   - 無需手動輸入，完全自動化！

2. **追蹤單號管理**
   - 新增 10 碼貨號追蹤
   - 自動開啟新竹物流官網查詢頁面
   - 手動更新貨態狀態
   - 刪除追蹤項目

3. **狀態管理**
   - 本地儲存追蹤資料（LocalStorage）
   - 記錄完整貨態歷程
   - 顯示貨態狀態徽章（待查詢/運送中/已送達）
   - 支援多種貨態：配達、集貨、到著、客戶不在、地址錯誤等

4. **桌面通知**
   - 瀏覽器原生 Notification API
   - 貨物送達時自動通知
   - 測試通知功能

5. **自動輪詢**
   - 可設定輪詢間隔（5分鐘/10分鐘/30分鐘/1小時）
   - 自動查詢未送達的包裹
   - 送達時立即通知

6. **響應式設計**
   - 支援桌面與手機瀏覽器
   - 現代化 UI/UX 設計（莫蘭迪色系）
   - 流暢的動畫效果

## 使用方式

### 快速開始

#### 方法 A：本地使用（無自動查詢功能）

1. 直接開啟 `index.html` 檔案即可使用
2. 輸入 10 碼貨號，點擊「新增追蹤」
3. 使用「🔍」手動前往官網查詢
4. 使用「➕」手動新增貨態記錄

#### 方法 B：部署到 Vercel（完整功能）⭐ 推薦

1. **部署到 Vercel**（5 分鐘完成）
   - 詳細步驟請參考 [DEPLOY.md](./DEPLOY.md)

2. **使用 🤖 自動查詢**
   - 輸入 10 碼貨號，點擊「新增追蹤」
   - 點擊「🤖」按鈕，系統會自動查詢並更新貨態
   - 完全自動化，無需手動輸入！

3. **啟用自動輪詢**
   - 勾選「自動輪詢」
   - 選擇間隔時間（建議 10 分鐘）
   - 系統會自動查詢所有未送達包裹
   - 送達時立即桌面通知

### 功能說明

#### 新增追蹤
- 輸入 10 碼貨號（純數字，例如：6714484884）
- 點擊「➕ 新增追蹤」或按 Enter
- 貨號會立即加入追蹤清單

#### 🤖 自動查詢（需部署到 Vercel）
- 點擊「🤖」按鈕
- 系統自動呼叫新竹物流 API
- 自動解析所有貨態記錄
- 自動新增到貨態歷程
- 完全自動化，無需任何手動操作！

#### 手動新增狀態
- 點擊「➕」按鈕
- 選擇貨態編號或直接輸入狀態文字
- 系統會記錄更新時間和狀態

#### 查詢貨態
- 點擊「🔍」按鈕前往官網查詢
- 查詢頁面網址格式：`https://cagweb01.hct.com.tw/pls/hctweb/C_PIKAM020AS?pACT=C_POKAM31&pINVOICE_NO=貨號`

#### 刪除追蹤
- 點擊「🗑️」按鈕刪除該追蹤項目

#### 自動輪詢提醒
- 勾選「自動輪詢」核取方塊
- 選擇輪詢間隔（5/10/30/60 分鐘）
- 系統會定期提醒您查詢未送達包裹
- 可一鍵批次開啟所有查詢頁面

## 技術說明

### 技術棧
- 純前端：HTML5 + CSS3 + JavaScript (ES6+)
- 無需後端伺服器
- 無外部依賴

### 資料儲存
- 使用 LocalStorage 本地儲存
- 資料格式：
```javascript
{
  trackingNumber: "1234567890",  // 貨號
  addedAt: "2025-03-15T10:30:00.000Z",  // 新增時間
  lastUpdate: "2025-03-15T14:30:00.000Z",  // 最後更新時間
  lastStatus: "貨件由北投營業所人員配送中。",  // 最新狀態
  statusCode: "H01",  // 狀態代碼
  isDelivered: false  // 是否已送達
}
```

### 貨態代碼對照

根據新竹物流官方 API 文件：

| 代碼 | 說明 | 分類 |
|------|------|------|
| A01 | 集貨（已取件） | 集貨中 |
| A04 | 到著（已到站，分貨中） | 配送中 |
| H01 | 配達（配送中） | 配送中 |
| H04 | 客戶不在 | 異常 |
| H05 | 地址錯誤 | 異常 |
| delivered | 正常配交（已送達） | 已完成 |

完整貨況對應表請參考 API 文件附件。

## 限制說明

### 純前端限制
由於是純前端應用，受到以下技術限制：

1. **無法完全自動查詢貨態**
   - 新竹物流 API 需要 DES CBC 加密和公司申請的金鑰
   - 前端無法安全儲存金鑰
   - CORS 政策阻止跨域請求
   - **解決方案**：使用 🤖 按鈕「快速新增」功能
     - 自動開啟查詢頁面
     - 3 秒後彈出輸入框
     - 快速複製貼上貨態文字

2. **需要手動確認貨態**
   - 無法 100% 自動取得最新貨態
   - **解決方案**：
     - 使用 🤖 快速新增（最快）
     - 或使用自動輪詢提醒（定期提醒查詢）
     - 批次開啟多個查詢頁面

3. **跨瀏覽器同步**
   - 資料儲存在 LocalStorage，無法跨裝置/瀏覽器
   - **解決方案**：未來可考慮使用雲端儲存服務

### 推薦的進階方案

如果需要自動查詢功能，建議：

1. **申請新竹物流 API**
   - 聯絡新竹物流營業所申請 API 權限
   - 取得加密金鑰（Key、IV、v 值）

2. **建立後端服務**
   - 使用 Node.js / Python / PHP 等建立後端
   - 在後端實作 DES CBC 加密
   - 定期呼叫新竹物流 API 更新貨態
   - 前端透過自己的 API 取得資料

3. **使用第三方服務**
   - 17TRACK、AfterShip 等第三方物流追蹤服務
   - 已整合多家物流公司 API

## 瀏覽器支援

- Chrome 88+
- Firefox 85+
- Safari 14+
- Edge 88+

需支援：
- LocalStorage
- Notification API
- ES6+ JavaScript

## 檔案結構

```
hct-tracker/
├── index.html          # 主頁面
├── style.css           # 樣式表
├── script.js           # JavaScript 邏輯
├── README.md           # 說明文件
└── API服務說明_V1 (2).pdf  # 新竹物流 API 文件
```

## 授權

本專案僅供個人學習與使用。

新竹物流貨物追蹤資訊僅提供追蹤交由新竹物流配送貨件的資訊，未經授權請勿作為他用。

## 聯絡資訊

如使用上有任何問題：
- 新竹物流客服：02-2837-1122
- 營運時間：週一至週六 08:00-16:00

## 更新日誌

### v1.0.0 (2025-10-20)
- ✅ 初始版本發布
- ✅ 追蹤單號管理
- ✅ 狀態手動更新
- ✅ 桌面通知功能
- ✅ 自動輪詢提醒
- ✅ 響應式設計

## 截圖

（請自行截圖）

## 常見問題 FAQ

### Q: 為什麼不能自動查詢貨態？
A: 新竹物流 API 需要公司申請的加密金鑰，純前端無法安全實作。本工具採用手動查詢 + 自動提醒的方式。

### Q: 資料會不會遺失？
A: 資料儲存在瀏覽器的 LocalStorage 中，清除瀏覽器資料會導致資料遺失。建議定期備份重要單號。

### Q: 可以同時追蹤多少個包裹？
A: 沒有數量限制，但建議不要超過 50 個以維持效能。

### Q: 輪詢提醒會消耗很多資源嗎？
A: 不會。輪詢只是定期彈出提醒，不會實際發送網路請求，資源消耗極低。

### Q: 支援行動裝置嗎？
A: 支援！本網頁採用響應式設計，可在手機、平板上正常使用。

### Q: 可以匯出/匯入追蹤清單嗎？
A: 目前版本尚未支援，但可在開發者工具中手動複製 LocalStorage 資料。

## 開發計畫

未來可能新增的功能：
- [ ] 匯出/匯入追蹤清單（JSON）
- [ ] 歷史記錄查詢
- [ ] 貨態時間軸視覺化
- [ ] PWA 支援（離線使用）
- [ ] 多語言支援
- [ ] 暗黑模式

---

**注意**：本工具為非官方工具，與新竹物流無關聯。使用前請詳閱新竹物流服務條款。
